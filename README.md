# üçΩÔ∏è YOLO Training Project - –î–µ—Ç–µ–∫—Ü–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –æ–±–µ–¥–µ–Ω–Ω–æ–≥–æ —Å—Ç–æ–ª–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ–±—É—á–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è YOLO –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å—Ç–æ–ª–æ–≤–æ–π –ø–æ—Å—É–¥—ã. –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å `best.pt` –∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –¥–µ—Ç–µ–∫—Ü–∏–∏ 6 –∫–ª–∞—Å—Å–æ–≤ —Å—Ç–æ–ª–æ–≤–æ–π –ø–æ—Å—É–¥—ã:
- `cutlery_basket` - –∫–æ—Ä–∑–∏–Ω–∞ –¥–ª—è —Å—Ç–æ–ª–æ–≤—ã—Ö –ø—Ä–∏–±–æ—Ä–æ–≤
- `foodboard` - —Ä–∞–∑–¥–µ–ª–æ—á–Ω–∞—è –¥–æ—Å–∫–∞  
- `plate` - —Ç–∞—Ä–µ–ª–∫–∞
- `soup_bowl` - —Å—É–ø–æ–≤–∞—è —Ç–∞—Ä–µ–ª–∫–∞
- `teacup` - —á–∞–π–Ω–∞—è —á–∞—à–∫–∞
- `teapot` - —á–∞–π–Ω–∏–∫

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
git clone <–≤–∞—à-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>
cd yolo_training_test
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
python -m venv .venv

# –î–ª—è macOS/Linux:
source .venv/bin/activate

# –î–ª—è Windows:
.venv\Scripts\activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install ultralytics==8.* matplotlib pandas opencv-python albumentations
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
yolo_training_test/
‚îú‚îÄ‚îÄ project/
‚îÇ   ‚îú‚îÄ‚îÄ dataset/                # –î–∞—Ç–∞—Å–µ—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–∑–º–µ—Ç–∫–æ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train/              # –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ val/                # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test/               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ scripts/                # –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ train.py            # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ detect_video.py     # –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞ –≤–∏–¥–µ–æ
‚îÇ       ‚îú‚îÄ‚îÄ augment.py          # –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îî‚îÄ‚îÄ extract_frames.py   # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ runs/                       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ plots/                      # –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ data/                       # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îî‚îÄ‚îÄ best.pt                     # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (–≤–∫–ª—é—á–µ–Ω–∞ –≤ –ø—Ä–æ–µ–∫—Ç)
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞ –≤–∏–¥–µ–æ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å:**

```bash
cd project/scripts
python detect_video.py
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –≤–∏–¥–µ–æ –ø–æ –ø—É—Ç–∏ `data/videos/4.MOV`. –ï—Å–ª–∏ —É –≤–∞—Å –¥—Ä—É–≥–æ–µ –≤–∏–¥–µ–æ, –∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –≤ —Ñ–∞–π–ª–µ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –µ–≥–æ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç.

**–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ:**
```python
# –í —Ñ–∞–π–ª–µ detect_video.py –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
video_path = "–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–≤–∏–¥–µ–æ.mp4"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–µ–æ—Ñ–∞–π–ª `output.mp4` —Å –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–º–∏ bounding box'–∞–º–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.

### 2. –û–±—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –∏–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```bash
cd project/scripts
python train.py
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤** –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ `train.py`:

```python
EXPERIMENTS = [
    dict(
        name="baseline",
        model="runs/detect/train3/weights/best.pt",  # –ü—É—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏
        data="project/dataset/data.yaml",
        epochs=30,
        imgsz=640,
        batch=16,
        lr0=0.01,
        device="mps",  # –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ "0" –¥–ª—è NVIDIA GPU –∏–ª–∏ "cpu" –¥–ª—è CPU
    ),
]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è:**
- –í–µ—Å–∞ –º–æ–¥–µ–ª–∏: `runs/detect/YOLOv11_<–∏–º—è_—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞>/weights/`
- –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è: `plots/`
- CSV —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏: `results.csv`
- JSON –ª–æ–≥–∏: `YOLOv11_<–∏–º—è>_history.json`

### 3. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:

```bash
cd project/scripts
python augment.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–ø–æ–≤–æ—Ä–æ—Ç, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏ –∏ —Ç.–¥.)
- –°–æ–∑–¥–∞–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ `project/dataset/images_aug/`
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã bounding box'–æ–≤

### 4. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–∑ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤:

```bash
cd project/scripts
python extract_frames.py
```

–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–¥—Ä—ã –∏–∑ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ `data/videos/` —Å —á–∞—Å—Ç–æ—Ç–æ–π 1 FPS.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

### –î–ª—è —Ä–∞–∑–Ω—ã—Ö GPU/—É—Å—Ç—Ä–æ–π—Å—Ç–≤:

**NVIDIA GPU:**
```python
device="0"  # –∏–ª–∏ "cuda"
```

**Apple Silicon (M1/M2):**
```python
device="mps"
```

**CPU only:**
```python
device="cpu"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ batch size

–ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫–∏ –ø–∞–º—è—Ç–∏, —É–º–µ–Ω—å—à–∏—Ç–µ batch size:
```python
batch=8  # –∏–ª–∏ –¥–∞–∂–µ batch=4 –¥–ª—è —Å–ª–∞–±—ã—Ö GPU
```

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

1. **CSV —Ñ–∞–π–ª —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏** (`results.csv`):
   - mAP50 - —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ IoU 0.5
   - mAP50-95 - —Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º IoU
   - precision, recall, F1

2. **–ì—Ä–∞—Ñ–∏–∫–∏ –≤ –ø–∞–ø–∫–µ `plots/`**:
   - `loss_<–∏–º—è>.png` - –∫—Ä–∏–≤—ã–µ –ø–æ—Ç–µ—Ä—å
   - `precision_recall.png` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

3. **–í–µ—Å–∞ –º–æ–¥–µ–ª–∏**:
   - `best.pt` - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ validation mAP
   - `last.pt` - –ø–æ—Å–ª–µ–¥–Ω—è—è —ç–ø–æ—Ö–∞


## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–£–≤–µ–ª–∏—á—å—Ç–µ batch size** –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∞–º—è—Ç—å)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU** –≤–º–µ—Å—Ç–æ CPU
3. **–£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (`imgsz=320`) –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏
4. **–£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö** –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏

## üé® –°ustom–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–µ—Ç–µ–∫—Ü–∏–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `project/dataset/data.yaml`:
```yaml
nc: <–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∞—Å—Å–æ–≤>
names: ['–∫–ª–∞—Å—Å1', '–∫–ª–∞—Å—Å2', ...]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å –≤ —Å–ø–∏—Å–æ–∫ `EXPERIMENTS` –≤ `train.py`:
```python
dict(
    name="–º–æ–π_—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç",
    model="yolo11n.pt",
    epochs=100,
    batch=32,
    # ... –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
),
```
